<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pcitc.smc.csv.dao.ESMEventDao">
	<sql id="insertKey">
		EVENTID,
	BASEEVENTIDS,
	NAME,
	MESSAGE,
	TYPE,
	ENDTIME,
	APPLICATIONPROTOCOL,
	TRANSPORTPROTOCOL,
	BYTESIN,
	BYTESOUT,
	CUSTOMER,
	CUSTOMERNAME,
	STARTTIME,
	MANAGERRECEIPTTIME,
	CATEGORYSIGNIFICANCE,
	CATEGORYTECHNIQUE,
	CATEGORYBEHAVIOR,
	CATEGORYDEVICEGROUP,
	CATEGORYOBJECT,
	CATEGORYOUTCOME,
	FILENAME,
	FILEPATH,
	REQUESTCOOKIES,
	REQUESTMETHOD,
	REQUESTPROTOCOL,
	REQUESTURL,
	REQUESTURLFILENAME,
	REQUESTURLPORT,
	REQUESTURLHOST,
	REQUESTURLQUERY,
	REQUESTCONTEXT,
	SOURCEADDRESS,
	SOURCEASSETNAME,
	SOURCEHOSTNAME,
	SOURCEMACADDRESS,
	SOURCEPORT,
	SOURCEPROCESSNAME,
	SOURCESERVICENAME,
	SOURCETRANSLATEDADDRESS,
	SOURCETRANSLATEDPORT,
	SOURCEUSERID,
	SOURCEUSERNAME,
	SOURCEZONENAME,
	SOURCEGEOCOUNTRYNAME,
	SOURCEGEOLOCATIONINFO,
	TARGETADDRESS,
	TARGETASSETNAME,
	TARGETHOSTNAME,
	TARGETMACADDRESS,
	TARGETPORT,
	TARGETPROCESSNAME,
	TARGETSERVICENAME,
	TARGETTRANSLATEDADDRESS,
	TARGETTRANSLATEDPORT,
	TARGETUSERID,
	TARGETUSERNAME,
	TARGETZONENAME,
	TARGETGEOCOUNTRYNAME,
	TARGETGEOLOCATIONINFO,
	ASSETCRITICALITY,
	MODELCONFIDENCE,
	PRIORITY,
	RELEVANCE,
	SEVERITY,
	DEVICECUSTOMSTRING1,
	DEVICECUSTOMSTRING2,
	DEVICECUSTOMSTRING3,
	DEVICECUSTOMSTRING4,
	DEVICECUSTOMSTRING5,
	DEVICECUSTOMSTRING6,
	DEVICECUSTOMNUMBER1,
	DEVICECUSTOMNUMBER2,
	DEVICECUSTOMNUMBER3,
	DEVICECUSTOMDATE1,
	DEVICECUSTOMDATE2,
	DEVICEACTION,
	DEVICEADDRESS,
	DEVICEASSETID,
	DEVICEASSETNAME,
	DEVICEDIRECTION,
	DEVICEDOMAIN,
	DEVICEEVENTCATEGORY,
	DEVICEEVENTCLASSID,
	DEVICEFACILITY,
	DEVICEHOSTNAME,
	DEVICEINBOUNDINTERFACE,
	DEVICEOUTBOUNDINTERFACE,
	DEVICEPROCESSID,
	DEVICEPROCESSNAME,
	DEVICEPRODUCT,
	DEVICERECEIPTTIME,
	DEVICESEVERITY,
	DEVICETRANSLATEDADDRESS,
	DEVICEVENDOR,
	DEVICEZONE,
	DEVICEZONENAME,
	AGENTADDRESS,
	AGENTHOSTNAME,
	AGENTNAME,
	AGENTRECEIPTTIME,
	AGENTSEVERITY
	</sql>
	<sql id="insertValue">
	#{eventId},#{baseEventIds},#{name},#{message},
		#{type},#{endTime},#{applicationProtocol},#{transportProtocol},
		#{bytesIn},#{bytesOut},#{customer},#{customerName},#{startTime},
		#{managerReceiptTime},#{categorySignificance},#{categoryTechnique},
		#{categoryBehavior},#{categoryDeviceGroup},#{categoryObject},
		#{categoryOutcome},#{fileName},#{filePath},#{requestCookies},
		#{requestMethod},#{requestProtocol},#{requestUrl},
		#{requestUrlFileName},#{requestUrlPort},#{requestUrlHost},
		#{requestUrlQuery},#{requestContext},#{sourceAddress},
		#{sourceAssetName},#{sourceHostName},#{sourceMacAddress},
		#{sourcePort},#{sourceProcessName},#{sourceServiceName},
		#{sourceTranslatedAddress},#{sourceTranslatedPort},#{sourceUserId},
		#{sourceUserName},#{sourceZoneName},#{sourceGeoCountryName},
		#{sourceCeoLocationInfo},#{targetAddress},#{targetAssetName},
		#{targetHostName},#{targetMacAddress},#{targetPort},
		#{targetProcessName},#{targetServiceName},
		#{targetTranslatedAddress},#{targetTranslatedPort},#{targetUserId},
		#{targetUserName},#{targetZoneName},#{targetGeoCountryName},
		#{targetCeoLocationInfo},#{assetCriticality},#{modelConfidence},
		#{priority},#{relevance},#{severity},#{deviceCustomString1},
		#{deviceCustomString2},#{deviceCustomString3},
		#{deviceCustomString4},#{deviceCustomString5},
		#{deviceCustomString6},#{deviceCustomNumber1},
		#{deviceCustomNumber2},#{deviceCustomNumber3},#{deviceCustomDate1},
		#{deviceCustomDate2},#{deviceAction},#{deviceAddress},
		#{deviceAssetId},#{deviceAssetName},#{deviceDirection},
		#{deviceDomain},#{deviceEventCategory},#{deviceEventClassId},
		#{deviceFacility},#{deviceHostName},#{deviceInboundInterface},
		#{deviceOutboundInterface},#{deviceProcessId},#{deviceProcessName},
		#{deviceProduct},#{deviceReceiptTime},#{deviceSeverity},
		#{deviceTranslatedAddress},#{deviceVendor},#{deviceZone},
		#{deviceZoneName},#{agentAddress},#{agentHostName},#{agentName},
		#{agentReceiptTime},#{agentSeverity}
	</sql>
	<sql id="insertValues">
		(#{esm.eventId},#{esm.baseEventIds},#{esm.name},#{esm.message},
		#{esm.type},#{esm.endTime},#{esm.applicationProtocol},#{esm.transportProtocol},
		#{esm.bytesIn},#{esm.bytesOut},#{esm.customer},#{esm.customerName},#{esm.startTime},
		#{esm.managerReceiptTime},#{esm.categorySignificance},#{esm.categoryTechnique},
		#{esm.categoryBehavior},#{esm.categoryDeviceGroup},#{esm.categoryObject},
		#{esm.categoryOutcome},#{esm.fileName},#{esm.filePath},#{esm.requestCookies},
		#{esm.requestMethod},#{esm.requestProtocol},#{esm.requestUrl},
		#{esm.requestUrlFileName},#{esm.requestUrlPort},#{esm.requestUrlHost},
		#{esm.requestUrlQuery},#{esm.requestContext},#{esm.sourceAddress},
		#{esm.sourceAssetName},#{esm.sourceHostName},#{esm.sourceMacAddress},
		#{esm.sourcePort},#{esm.sourceProcessName},#{esm.sourceServiceName},
		#{esm.sourceTranslatedAddress},#{esm.sourceTranslatedPort},#{esm.sourceUserId},
		#{esm.sourceUserName},#{esm.sourceZoneName},#{esm.sourceGeoCountryName},
		#{esm.sourceCeoLocationInfo},#{esm.targetAddress},#{esm.targetAssetName},
		#{esm.targetHostName},#{esm.targetMacAddress},#{esm.targetPort},
		#{esm.targetProcessName},#{esm.targetServiceName},
		#{esm.targetTranslatedAddress},#{esm.targetTranslatedPort},#{esm.targetUserId},
		#{esm.targetUserName},#{esm.targetZoneName},#{esm.targetGeoCountryName},
		#{esm.targetCeoLocationInfo},#{esm.assetCriticality},#{esm.modelConfidence},
		#{esm.priority},#{esm.relevance},#{esm.severity},#{esm.deviceCustomString1},
		#{esm.deviceCustomString2},#{esm.deviceCustomString3},
		#{esm.deviceCustomString4},#{esm.deviceCustomString5},
		#{esm.deviceCustomString6},#{esm.deviceCustomNumber1},
		#{esm.deviceCustomNumber2},#{esm.deviceCustomNumber3},#{esm.deviceCustomDate1},
		#{esm.deviceCustomDate2},#{esm.deviceAction},#{esm.deviceAddress},
		#{esm.deviceAssetId},#{esm.deviceAssetName},#{esm.deviceDirection},
		#{esm.deviceDomain},#{esm.deviceEventCategory},#{esm.deviceEventClassId},
		#{esm.deviceFacility},#{esm.deviceHostName},#{esm.deviceInboundInterface},
		#{esm.deviceOutboundInterface},#{esm.deviceProcessId},#{esm.deviceProcessName},
		#{esm.deviceProduct},#{esm.deviceReceiptTime},#{esm.deviceSeverity},
		#{esm.deviceTranslatedAddress},#{esm.deviceVendor},#{esm.deviceZone},
		#{esm.deviceZoneName},#{esm.agentAddress},#{esm.agentHostName},#{esm.agentName},
		#{esm.agentReceiptTime},#{esm.agentSeverity})
	</sql>
	<insert id="saveESMEvent" parameterType="com.pcitc.smc.csv.model.ESMEvent"
		flushCache="true">
		INSERT INTO EVENT (
		<include refid="insertKey"/>
		) VALUES ( 
		<include refid="insertValue"/>
		)
	</insert>
	<insert id="call_dataToType">
		{call DATATOTYPE()}
	</insert>
	
	<insert id="saveESMEventBatch">
		INSERT INTO EVENT (
		<include refid="insertKey"/>
		) VALUES 
		<foreach collection="items" item="esm" separator=",">
			<include refid="insertValues"/>
		</foreach>
	</insert>

</mapper>